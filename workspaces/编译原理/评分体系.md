# 编译原理实训 · 评分体系

本文档记录当前采用的评估维度、权重与评分细节，便于内部评估与外部评估对齐，并随实践持续补充。

---

## 一、总体框架

- **总分**：100 分  
- **维度**：5 大维度，各 20 分，下设若干子维度。  
- **评级**：优秀(≥90%)、良好(≥70%)、合格(≥60%)、不合格(<60%)。  
- **一票否决**：目标达成度得分低于阈值时，总评级可降为「一票否决」。

---

## 二、五大维度与子维度（与内部评估器一致）

| 维度         | 权重 | 子维度               | 子权重 | 说明 |
|--------------|------|----------------------|--------|------|
| 目标达成度   | 20%  | 知识点覆盖率         | 10     | 教学内容的知识点是否被充分覆盖 |
|              |      | 能力覆盖率           | 10     | 学生能力培养目标是否达成 |
| 流程遵循度   | 20%  | 环节准入条件         | 4      | 进入下一环节前是否满足前置条件 |
|              |      | 环节内部顺序         | 4      | 环节内对话是否按预期顺序展开 |
|              |      | 全局环节流转         | 4      | 整体场景流转是否符合设计 |
|              |      | 环节准出检查         | 4      | 离开环节时是否完成必要内容 |
|              |      | 非线性跳转处理       | 4      | 异常跳转时的处理是否合理 |
| 交互体验性   | 20%  | 人设语言风格         | 4      | NPC 是否保持设定的角色风格 |
|              |      | 表达自然度           | 4      | 对话是否流畅自然 |
|              |      | 上下文衔接           | 4      | 对话是否保持连贯 |
|              |      | 循环僵局             | 4      | 是否能避免/跳出重复循环 |
|              |      | 回复长度控制         | 4      | 回复长度是否适当（见下方细则） |
| 幻觉与边界   | 20%  | 事实正确性           | 4      | 陈述的事实是否准确（含实验规范） |
|              |      | 逻辑自洽性           | 4      | 对话内容是否逻辑一致 |
|              |      | 未知承认             | 4      | 对不确定的内容是否坦诚 |
|              |      | 安全围栏             | 4      | 是否避免敏感/不当内容 |
|              |      | 干扰抵抗             | 4      | 是否能抵抗学生的干扰/诱导 |
| 教学策略     | 20%  | 启发式提问频率       | 5      | 是否善于用问题引导思考 |
|              |      | 正向激励机制         | 5      | 是否给予适当的鼓励和肯定 |
|              |      | 纠错引导路径         | 5      | 发现错误时的纠正方式是否得当 |
|              |      | 深度追问技巧         | 5      | 是否能深入挖掘学生理解 |

---

## 三、评分细节与扣分项（约定）

以下为已约定的评分细节，用于人工或规则辅助评分时一致执行。

### 3.1 输出规范（建议在「交互体验性·回复长度控制」或「幻觉与边界」中体现）

| 项目           | 说明 | 建议 |
|----------------|------|------|
| **括号内容泄露** | 智能体回复中出现括号内的教学备注、阶段说明、操作指引（如「等待学生回答后…」「若正确则…」），学生不应看到。 | 每处扣 1–2 分（或在该轮「表达自然度/事实正确性」中体现），严重多处以降档处理。 |
| **卡片编号泄露** | 回复正文中出现「卡片2A」「卡片3B」等内部编号（转折时单独一行输出卡片编号除外）。 | 每处扣 1–2 分，视为不该对学生展示的内容。 |
| **回复过长**     | 单轮回复超过约定字数（当前约定 80–120 字，适合语音）。 | 可在此轮「回复长度控制」中扣分或降档。 |

### 3.2 实验规范与事实正确性（建议在「目标达成度·知识点覆盖率」与「幻觉与边界·事实正确性」中体现）

| 项目           | 说明 | 建议 |
|----------------|------|------|
| **词法规则错误** | 实验语言关键字必须为 **begin, if, then, while, do, end**；不得改为 if/else/while/int/return 等。 | 若擅自修改关键字集合，属严重偏离，扣分从重（如 5–8 分或该子维度不及格）。 |
| **种别码表错误** | 应完整给出 begin=1, if=2, then=3, while=4, do=5, end=6, ID=10, NUM=11, #=0；不得缺漏或错配。 | 缺漏或错配按严重程度扣 2–5 分。 |
| **二元组格式**   | 明确区分：关键字/运算符/界符用 (syn, token)，NUM 用 (syn, sum)。 | 混淆或未讲清可扣 1–3 分。 |
| **rwtab 与函数职责** | 关键字表为 rwtab={"begin":1, "if":2, "then":3, "while":4, "do":5, "end":6}；m_getch 只读下一字符，getbc 负责跳过空白。 | 与实验要求不符或职责讲错，扣 2–4 分。 |

### 3.3 流程与过渡（建议在「流程遵循度」各子维度中体现）

| 项目             | 说明 | 建议 |
|------------------|------|------|
| **过渡语不完整** | 指出不足版出现「存在一些问题，比如。」等说不清具体问题的表述。 | 扣 1–2 分，并要求可操作改进（先具体指出缺失再过渡）。 |
| **误判达标为不达标** | 学生已正确完成本环节目标，仍使用指出不足版或给予负面评价。 | 在「环节准出检查/全局环节流转」中扣分，建议 2–4 分。 |
| **环节未达标即跳转** | 未完成前置条件（如工具函数实现、reserve 验证）就进入下一环节。 | 在「环节准入条件」中扣分。 |

### 3.4 教学策略

| 项目         | 说明 | 建议 |
|--------------|------|------|
| **纠正错误理解** | 学生有明显错误（如 m_getch 要跳过空白）时，应先纠正再决定是否进入下一环节。 | 未纠正即跳转，在「纠错引导路径」或「环节准入条件」中扣分。 |

---

## 四、使用说明

- **内部评估**：当前由 `simulator.evaluator` 按五大维度调用 LLM 打分；上述细节可作为 prompt 补充或后处理规则逐步接入。  
- **外部评估**：人工或外部系统打分时，可据此统一扣分标准，便于与内部评估或优化器对齐。  
- **迭代**：新发现的典型问题与扣分约定可继续追加到第三节，并注明日期或版本。

---

*文档建立日期：2026-02-05。*
