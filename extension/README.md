# EduFlow 智慧树卡片注入 - Chrome 插件

任意页面均可打开扩展；按六步流程完成「选择文件 → 选框架 → 选人设 → 选评分 → 生成卡片 → 注入平台」。无需配置 Cookie/课程/任务/节点 ID。

## 使用前提

- **默认**：扩展使用 [eduflows.cn](https://eduflows.cn) 后端，无需配置。
- **本地部署**：若本地运行网站，在侧边栏展开「EduFlow 后端 API」并改为 `http://localhost:端口`。
- 注入前需打开**智慧树能力训练配置页**（某门课的卡片编辑页），扩展会自动检测当前标签页是否为该页面。

## 安装

1. Chrome 地址栏输入 `chrome://extensions/`，打开「扩展程序」。
2. 开启右上角「开发者模式」。
3. 点击「加载已解压的扩展程序」，选择本项目的 `extension` 目录。

## 六步流程

1. **选择文件**：拖入或选择 .md / .docx / .pdf 剧本。后端自动解析、生成 trainset、生成学生角色（人设）。
2. **选择生成框架**：从下拉选择卡片生成框架（如 dspy）；后续可接入新生成逻辑。
3. **选择学生角色**：从预设或本次生成的人设中选择；可查看并编辑 YAML 内容后保存。
4. **选择评分体系**：当前为占位选项（默认）；后续将接入新评分体系。
5. **生成卡片**：点击「生成卡片」得到 Markdown；可在文本框内编辑后再执行注入。
6. **注入平台**：确保当前标签页为智慧树能力训练配置页，点击「注入平台」。完成后刷新画布即可看到新卡片。

## 可选：.docx / .pdf 支持

- 使用**后端解析**时，.md / .docx / .pdf 均由服务端解析，无需在扩展内放置额外库。
- 若需在**未连接后端**时本地预览 .docx / .pdf 文本，可将 mammoth（.docx）或 PDF.js（.pdf）放入 `extension/lib/`，详见原说明。

## 文件说明

- `manifest.json` - 插件配置与权限（含 sidePanel）。
- `background.js` - 认证、智慧树 API、当前标签页检测。
- `sidepanel.html` / `sidepanel.js` / `sidepanel.css` - 侧边栏六步流程 UI。
- `content.js` - 仅在智慧树配置页运行，响应「注入平台」并执行注入。
